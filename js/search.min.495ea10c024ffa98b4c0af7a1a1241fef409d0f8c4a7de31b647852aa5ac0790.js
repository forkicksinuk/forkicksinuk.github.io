(function(){"use strict";var e,t,n,s,o,i,a,c,l,d,u,h,m,f,p,g,v,b,r=document.querySelector("[data-search]");if(!r)return;if(t=r.querySelector("[data-search-input]"),e=r.querySelector("[data-search-results]"),!t||!e||typeof window.Fuse=="undefined")return;o=null,i=!1,n=-1,a=2,d=8,h=new URL("index.json",window.location.origin).toString(),v=function(e,t){var n;return function(){var s=this,o=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(s,o)},t)}},u=function(e){return(e||"").replace(/\s+/g," ").trim()},f=function(e,t){var s,o,i,a,r,c,l,n=u(e.summary)||u(e.content);return n?(o=160,t?(c=n.toLowerCase(),l=t.toLowerCase(),i=c.indexOf(l),i===-1?n.length>o?n.slice(0,o-1)+"…":n:(a=Math.max(0,i-40),r=Math.min(n.length,i+t.length+60),s=n.slice(a,r),a>0&&(s+="…"),r<n.length&&(s+="…"),s)):n.length>o?n.slice(0,o-1)+"…":n):""},m=function(){e.innerHTML="";var n=document.createElement("div");n.className="site-search__empty",n.textContent="Search is unavailable right now.",e.appendChild(n),e.hidden=!1,t.setAttribute("aria-expanded","true")},s=function(){e.innerHTML="",e.hidden=!0,t.setAttribute("aria-expanded","false"),n=-1},l=function(t){var s=e.querySelectorAll(".site-search__result");if(!s.length){n=-1;return}t<0?t=s.length-1:t>=s.length&&(t=0),s.forEach(function(e,n){var s=n===t;e.classList.toggle("is-active",s),e.setAttribute("aria-selected",s?"true":"false")}),s[t].scrollIntoView({block:"nearest"}),n=t},p=function(o){if(e.innerHTML="",n=-1,!o.length){var r,a=document.createElement("div");a.className="site-search__empty",a.textContent="No results found.",e.appendChild(a),e.hidden=!1,t.setAttribute("aria-expanded","true");return}if(r=document.createDocumentFragment(),o.slice(0,d).forEach(function(e,n){var s,i,a,c,o=e.item||e;if(!o||!o.permalink)return;s=document.createElement("a"),s.className="site-search__result",s.href=o.permalink,s.setAttribute("role","option"),s.setAttribute("aria-selected","false"),s.dataset.index=String(n),i=document.createElement("span"),i.className="site-search__result-title",i.textContent=o.title||"Untitled",s.appendChild(i),c=f(o,t.value.trim()),c&&(a=document.createElement("p"),a.className="site-search__result-summary",a.textContent=c,s.appendChild(a)),r.appendChild(s)}),e.appendChild(r),e.children.length===0){s();return}e.hidden=!1,t.setAttribute("aria-expanded","true")},g=function(){return o||i?Promise.resolve(o):(i=!0,fetch(h,{credentials:"same-origin",cache:"force-cache"}).then(function(e){if(!e.ok)throw new Error("Failed to fetch search index");return e.json()}).then(function(e){if(!Array.isArray(e))throw new Error("Invalid search index format");return o=new window.Fuse(e,{includeScore:!0,shouldSort:!0,threshold:.32,minMatchCharLength:2,ignoreLocation:!0,keys:[{name:"title",weight:.55},{name:"summary",weight:.25},{name:"content",weight:.2}]}),o}).catch(function(e){return console.error("[Search]",e),null}).finally(function(){i=!1}))},c=v(function(){var e=t.value.trim();if(e.length<a){s();return}g().then(function(t){if(!t){m();return}var n=t.search(e,{limit:d});p(n,e)})},180),b=function(o){if(e.hidden&&o.key!=="Escape")return;var i=e.querySelectorAll(".site-search__result");if(!i.length)return;switch(o.key){case"ArrowDown":o.preventDefault(),l(n+1);break;case"ArrowUp":o.preventDefault(),l(n<=0?i.length-1:n-1);break;case"Enter":n>=0&&n<i.length&&(o.preventDefault(),i[n].click());break;case"Escape":s(),t.blur();break;default:break}},t.addEventListener("input",c),t.addEventListener("keydown",b),t.addEventListener("focus",function(){t.value.trim().length>=a&&c()}),e.addEventListener("pointermove",function(e){var t,n=e.target.closest(".site-search__result");if(!n)return;t=Number(n.dataset.index),Number.isNaN(t)||l(t)}),document.addEventListener("pointerdown",function(e){r.contains(e.target)||s()}),window.addEventListener("pageshow",function(){t.value.trim().length>=a&&c()})})()