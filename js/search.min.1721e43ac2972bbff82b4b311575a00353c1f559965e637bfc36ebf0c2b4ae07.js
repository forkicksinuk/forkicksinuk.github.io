(function(){"use strict";var e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,g,v,b,j,y,_,w,O,x,p=document.querySelector("[data-search]");if(!p)return;if(typeof window.Fuse=="undefined")return;if(s=p.querySelector("[data-search-input]"),a=p.querySelector("[data-search-button]"),!s||!a)return;i=null,l=!1,e=null,n=null,t=null,d=null,u=null,r=null,c=2,b=12,O=new URL("index.json",window.location.origin).toString(),g=function(e){return(e||"").replace(/\s+/g," ").trim()},j=function(e,t){var s,o,i,a,r,c,l,n=g(e.summary)||g(e.content);return n?(o=160,t?(c=n.toLowerCase(),l=t.toLowerCase(),i=c.indexOf(l),i===-1?n.length>o?n.slice(0,o-3)+"...":n:(a=Math.max(0,i-40),r=Math.min(n.length,i+t.length+60),s=n.slice(a,r),a>0&&(s+="..."),r<n.length&&(s+="..."),s)):n.length>o?n.slice(0,o-3)+"...":n):""},y=function(e){if(!e)return"";try{var t=new Date(e);if(!Number.isNaN(t.getTime()))return t.toISOString().slice(0,10)}catch{}return e},_=function(){return i||l?Promise.resolve(i):(l=!0,fetch(O,{credentials:"same-origin",cache:"force-cache"}).then(function(e){if(!e.ok)throw new Error("Failed to fetch search index");return e.json()}).then(function(e){if(!Array.isArray(e))throw new Error("Invalid search index format");return i=new window.Fuse(e,{includeScore:!0,shouldSort:!0,threshold:.32,minMatchCharLength:2,ignoreLocation:!0,keys:[{name:"title",weight:.55},{name:"summary",weight:.25},{name:"content",weight:.2}]}),i}).catch(function(e){return console.error("[Search]",e),null}).finally(function(){l=!1}))},o=function(e){if(!t)return;t.innerHTML="";var n=document.createElement("p");n.className="site-search__modal-message",n.textContent=e,t.appendChild(n)},w=function(e,n){if(!t)return;if(t.innerHTML="",!e.length){o("No results found.");return}e.slice(0,b).forEach(function(e){var o,i,a,r,c,l,d,s=e&&e.item?e.item:e;if(!s)return;a=document.createElement("article"),a.className="post-card",o=document.createElement("a"),o.className="post-card__link",o.href=s.permalink||"#",r=document.createElement("h3"),r.className="post-card__title",r.textContent=s.title||"Untitled",i=document.createElement("div"),i.className="post-card__meta",c=function(e,t){if(!e)return;if(i.children.length>0){var n,s=document.createElement("span");s.className="post-card__separator",s.textContent="Â·",i.appendChild(s)}n=document.createElement("span"),n.className=t,n.textContent=e,i.appendChild(n)},c(y(s.date),"post-card__date"),c(s.location,"post-card__location"),c(s.author,"post-card__author"),o.appendChild(r),i.children.length>0&&o.appendChild(i),d=j(s,n),d&&(l=document.createElement("p"),l.className="post-card__summary",l.textContent=d,o.appendChild(l)),a.appendChild(o),t.appendChild(a)})},f=function(e){e.key==="Escape"&&(e.preventDefault(),m())},m=function(){if(!e||e.hidden)return;e.classList.remove("is-open"),document.body.classList.remove("is-search-open"),document.removeEventListener("keydown",f),s.setAttribute("aria-expanded","false"),a.setAttribute("aria-expanded","false");var n=!1,o=function(){if(n)return;n=!0,e.hidden=!0,t&&(t.innerHTML="")};e.addEventListener("transitionend",o,{once:!0}),window.setTimeout(o,250),r&&(r.focus(),r=null)},x=function(){if(e)return;e=document.createElement("div"),e.className="site-search__modal",e.id="site-search-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-labelledby","site-search-modal-title"),e.hidden=!0,e.innerHTML='<div class="site-search__modal-content" data-search-modal-content>  <header class="site-search__modal-header">    <h2 class="site-search__modal-title" id="site-search-modal-title">Search</h2>    <button class="site-search__modal-close" type="button" aria-label="Close search" data-search-close>      <span aria-hidden="true">&times;</span>    </button>  </header>  <form class="site-search__modal-form" data-search-form>    <label class="visually-hidden" for="site-search-modal-input">Search posts</label>    <div class="site-search__modal-field">      <input class="site-search__modal-input" id="site-search-modal-input" type="search" name="q" placeholder="Search posts..." autocomplete="off" autocapitalize="none" spellcheck="false" enterkeyhint="search" data-search-modal-input />      <button class="site-search__modal-submit" type="submit" aria-label="Run search">        <svg class="site-search__icon" viewBox="0 0 24 24" role="img" aria-hidden="true" focusable="false">          <circle cx="11" cy="11" r="6" fill="none" stroke="currentColor" stroke-width="1.6" />          <path d="M16 16l4.5 4.5" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />        </svg>      </button>    </div>  </form>  <div class="site-search__modal-results post-list" data-search-modal-results aria-live="polite"></div></div>',document.body.appendChild(e),n=e.querySelector("[data-search-modal-input]"),t=e.querySelector("[data-search-modal-results]"),d=e.querySelector("[data-search-form]"),u=e.querySelector("[data-search-close]"),u&&u.addEventListener("click",m),e.addEventListener("click",function(t){t.target===e&&m()}),d&&d.addEventListener("submit",function(e){e.preventDefault(),h(n.value)})},v=function(){if(x(),!e||!n||!t)return;if(!e.hidden)return;r=document.activeElement instanceof HTMLElement?document.activeElement:null,e.hidden=!1,requestAnimationFrame(function(){e.classList.add("is-open")}),document.body.classList.add("is-search-open"),document.addEventListener("keydown",f),s.setAttribute("aria-expanded","true"),a.setAttribute("aria-expanded","true"),t.innerHTML="",n.value=s.value.trim(),n.focus(),n.select()},h=function(e){if(!n||!t)return;var i=(e||"").trim();if(s.value=i,i.length<c){o("Please enter at least "+c+" characters.");return}o("Searching..."),_().then(function(e){if(!e){o("Search is unavailable right now.");return}var t=e.search(i,{limit:b});w(t,i)})},a.addEventListener("click",function(){v(),n&&t&&(n.value.trim().length>=c?h(n.value):o("Type a query and press Enter."))}),s.addEventListener("keydown",function(e){e.key==="Enter"&&(e.preventDefault(),v(),n&&t&&(n.value=s.value.trim(),n.value.length>=c?h(n.value):o("Type a query and press Enter.")))})})()